{"remainingRequest":"C:\\Users\\Ray\\WebstormProjects\\vote_app4\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Ray\\WebstormProjects\\vote_app4\\src\\views\\myVote.vue?vue&type=style&index=0&id=5f380a50&scoped=true&lang=css&","dependencies":[{"path":"C:\\Users\\Ray\\WebstormProjects\\vote_app4\\src\\views\\myVote.vue","mtime":1577801230475},{"path":"C:\\Users\\Ray\\WebstormProjects\\vote_app4\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Ray\\WebstormProjects\\vote_app4\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\Ray\\WebstormProjects\\vote_app4\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\Ray\\WebstormProjects\\vote_app4\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Ray\\WebstormProjects\\vote_app4\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCi5teVZvdGUgewogICAgbWFyZ2luLXRvcDogMzBweDsKICAgIG1hcmdpbi1ib3R0b206IDkwcHg7Cn0KCmhyIHsKICAgIG1hcmdpbi10b3A6IDBweDsKICAgIG1hcmdpbjogMDsKICAgIGJvcmRlcjogMDsKICAgIGNvbG9yOiAjZTBlMGUwOwogICAgYmFja2dyb3VuZC1jb2xvcjogI2UwZTBlMDsKICAgIGhlaWdodDogMXB4Cn0KCi5kZXRhaWwtdGV4dCB7CiAgICBvdmVyZmxvdzogaGlkZGVuOwogICAgdGV4dC1vdmVyZmxvdzogZWxsaXBzaXM7CiAgICBkaXNwbGF5OiBibG9jazsKICAgIGRpc3BsYXk6IC13ZWJraXQtYm94OwogICAgLXdlYmtpdC1saW5lLWNsYW1wOiAzOwogICAgLyohIGF1dG9wcmVmaXhlcjogb2ZmICovCiAgICAtd2Via2l0LWJveC1vcmllbnQ6IHZlcnRpY2FsOwogICAgLyogYXV0b3ByZWZpeGVyOiBvbiAqLwp9Cg=="},{"version":3,"sources":["myVote.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyNA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"myVote.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n    <div class=\"myVote\">\r\n        <van-row>\r\n            <van-col span=\"2\">\r\n                <img src=\"../assets/images/h1.png\" height=\"24px\" width=\"24px\" style=\"margin-left: 8px;margin-top: 6px\"/>\r\n            </van-col>\r\n            <van-col span=\"22\">\r\n                <span style=\"display: block;margin: 6px 0px\">我发起的投票</span>\r\n            </van-col>\r\n        </van-row>\r\n        <van-tabs v-model=\"active\">\r\n            <van-tab title=\"图文投票\">\r\n                <div v-for=\"(item,i) in voteList\" :key=i>\r\n                    <div v-if=\"item.flag==false\">\r\n                        <van-panel :title=item.title desc=\"标题\" :status=item.status>\r\n                            <div class=\"detail-text\" style=\"margin: 10px 16px\">{{item.description}}</div>\r\n                            <div slot=\"footer\" class=\"d-flex justify-content-end\">\r\n                                <van-button size=\"small\" style=\"margin-right: 10px\"\r\n                                            :to=\"{path:'/detail',query: { voteId: item.id }}\">详情\r\n                                </van-button>\r\n                                <van-button size=\"small\" style=\"margin-right: 10px\" @click=\"toShare(item.id,'/detail')\">分享\r\n                                </van-button>\r\n                                <van-button size=\"small\" type=\"danger\" @click=\"doDelete(item.id)\">删除</van-button>\r\n                            </div>\r\n                        </van-panel>\r\n                        <hr style=\"height: 7px\">\r\n                    </div>\r\n                </div>\r\n            </van-tab>\r\n            <van-tab title=\"问卷调查\">\r\n                <div v-for=\"(item,i) in quesList\" :key=i>\r\n                    <div v-if=\"item.flag==false\">\r\n                        <van-panel :title=item.title desc=\"标题\" :status=item.status>\r\n                            <div class=\"detail-text\" style=\"margin: 10px 16px\">{{item.description}}</div>\r\n                            <div slot=\"footer\" class=\"d-flex justify-content-end\">\r\n                                <van-button size=\"small\" style=\"margin-right: 10px\"\r\n                                            :to=\"{path:'/quesStart',query: { voteId: item.id }}\">详情\r\n                                </van-button>\r\n                                <van-button size=\"small\" style=\"margin-right: 10px\" @click=\"toShare(item.id,'/quesStart')\">分享\r\n                                </van-button>\r\n                                <van-button size=\"small\" type=\"danger\" @click=\"doDelete(item.id)\">删除</van-button>\r\n                            </div>\r\n                        </van-panel>\r\n                        <hr style=\"height: 7px\">\r\n                    </div>\r\n                </div>\r\n            </van-tab>\r\n        </van-tabs>\r\n        <van-dialog\r\n                v-model=\"showShare\"\r\n                title=\"手机扫一扫\"\r\n        >\r\n            <van-row type=\"flex\" justify=\"center\">\r\n                <van-col><img :src=QRcode></van-col>\r\n            </van-row>\r\n            <van-row type=\"flex\" justify=\"center\">\r\n                <van-col>\r\n                    <span>复制链接：{{shortUrl}}</span>\r\n                </van-col>\r\n            </van-row>\r\n        </van-dialog>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    export default {\r\n        name: \"myVote\",\r\n        data() {\r\n            return {\r\n                showShare: false,\r\n                isLogin: false,\r\n                loginUser: {},\r\n                active: 0,\r\n                voteList: [],\r\n                QRcode: '',\r\n                shortUrl: '',\r\n                quesList:[]\r\n            }\r\n        },\r\n        methods: {\r\n            getQuesList() {\r\n                let that = this;\r\n                let url = this.website + \"/questionnaire/getQues\"\r\n                this.axios.post(url,this.loginUser).then(function (response) {\r\n                    if (response.data.code == 200) {\r\n                        that.quesList = response.data.data;\r\n                        console.log(that.quesList)\r\n                    } else {\r\n                        console.log(\"查询失败\");\r\n                    }\r\n                }).catch(function (err) {\r\n                    // eslint-disable-next-line no-console\r\n                    console.log(err);\r\n                })\r\n            },\r\n            getVoteList() {\r\n                let that = this;\r\n                let url = this.website + \"/vote/getVote\"\r\n                this.axios.get(url, {\r\n                    params: {\r\n                        creatorId: this.loginUser.id\r\n                    }\r\n                }).then(function (response) {\r\n                    if (response.data.code == 200) {\r\n                        that.voteList = response.data.data;\r\n                    } else {\r\n                        console.log(\"查询失败\");\r\n                    }\r\n                }).catch(function (err) {\r\n                    // eslint-disable-next-line no-console\r\n                    console.log(err);\r\n                })\r\n            },\r\n            deleteVote(vote) {\r\n                let that = this;\r\n                let url = this.website + \"/vote/delVote\"\r\n                this.axios.post(url, vote).then(function (response) {\r\n                    if (response.data.code == 200) {\r\n                        that.$dialog.alert({\r\n                            message: '删除成功'\r\n                        }).then(() => {\r\n                            // on close\r\n                        });\r\n                    } else {\r\n                        that.$dialog.alert({\r\n                            message: '删除失败'\r\n                        }).then(() => {\r\n                            // on close\r\n                        });\r\n                    }\r\n                }).catch(function (err) {\r\n                    // eslint-disable-next-line no-console\r\n                    console.log(err);\r\n                })\r\n            },\r\n            doDelete(id) {\r\n                let that = this;\r\n                this.$dialog.confirm({\r\n                    message: '确认删除'\r\n                }).then(() => {\r\n                    // on confirm\r\n                    for (let i in that.voteList) {\r\n                        if (that.voteList[i].id == id) {\r\n                            that.voteList[i].flag = true;\r\n                            that.deleteVote(that.voteList[i]);\r\n                        }\r\n                    }\r\n                }).catch(() => {\r\n                    // on cancel\r\n                });\r\n            },\r\n            getQRcode(id,type) {\r\n                let that = this;\r\n                let longUrl = this.website2 + type+'?voteId=' + id;\r\n                let url2 = 'api/getQRcode';\r\n                this.axios.get(url2, {\r\n                    params: {\r\n                        text: longUrl,\r\n                        key: 'd6e93df58937b9995c52d7998b8513b8'\r\n                    }\r\n                },).then(function (response) {\r\n                    if (response.data.error_code == 0) {\r\n                        that.QRcode = \"data:image/png;base64,\" + response.data.result.base64_image;\r\n                    } else {\r\n                        console.log(response.data);\r\n                    }\r\n                }).catch(function (err) {\r\n                    // eslint-disable-next-line no-console\r\n                    console.log(err);\r\n                })\r\n            },\r\n            getShortUrl(id,type) {\r\n                let that = this;\r\n                let shareUrl = this.website2 + type+'?voteId=' + id;\r\n                let url = \"api/getShortUrl\"\r\n                this.axios.get(url, {\r\n                    params: {\r\n                        format: 'json',\r\n                        url: shareUrl,\r\n                        key: '5e09e1efb1b63c2d90541992@01d1f947328e5aa20680c754c12eef90',\r\n                        expireDate: '2020-03-31'\r\n                    }\r\n                }).then(function (response) {\r\n                    if (response.data.err == \"\") {\r\n                        that.shortUrl = response.data.url;\r\n                    } else {\r\n                        console.log(response.data)\r\n                    }\r\n                }).catch(function (err) {\r\n                    // eslint-disable-next-line no-console\r\n                    console.log(err);\r\n                })\r\n            },\r\n            toShare(id,type) {\r\n                this.getQRcode(id,type);\r\n                this.getShortUrl(id,type);\r\n                this.showShare = true;\r\n            }\r\n        },\r\n        mounted() {\r\n            if (sessionStorage.getItem(\"loginUser\") != null || localStorage.getItem(\"loginUser\") != null) {\r\n                this.isLogin = true;\r\n                if (sessionStorage.getItem(\"loginUser\") != null) {\r\n                    this.loginUser = JSON.parse(sessionStorage.getItem(\"loginUser\"));\r\n                }\r\n                if (localStorage.getItem(\"loginUser\") != null) {\r\n                    this.loginUser = JSON.parse(localStorage.getItem(\"loginUser\"));\r\n                }\r\n            }\r\n            this.getVoteList();\r\n            this.getQuesList();\r\n        }\r\n\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n    .myVote {\r\n        margin-top: 30px;\r\n        margin-bottom: 90px;\r\n    }\r\n\r\n    hr {\r\n        margin-top: 0px;\r\n        margin: 0;\r\n        border: 0;\r\n        color: #e0e0e0;\r\n        background-color: #e0e0e0;\r\n        height: 1px\r\n    }\r\n\r\n    .detail-text {\r\n        overflow: hidden;\r\n        text-overflow: ellipsis;\r\n        display: block;\r\n        display: -webkit-box;\r\n        -webkit-line-clamp: 3;\r\n        /*! autoprefixer: off */\r\n        -webkit-box-orient: vertical;\r\n        /* autoprefixer: on */\r\n    }\r\n</style>"]}]}