{"remainingRequest":"C:\\Users\\Ray\\WebstormProjects\\vote_app4\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Ray\\WebstormProjects\\vote_app4\\src\\views\\detail.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Ray\\WebstormProjects\\vote_app4\\src\\views\\detail.vue","mtime":1577808966776},{"path":"C:\\Users\\Ray\\WebstormProjects\\vote_app4\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Ray\\WebstormProjects\\vote_app4\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Ray\\WebstormProjects\\vote_app4\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Ray\\WebstormProjects\\vote_app4\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICAgIG5hbWU6ICJkZXRhaWwiLAogICAgZGF0YSgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBpc0xvZ2luOmZhbHNlLAogICAgICAgICAgICBsb2dpblVzZXI6e30sCiAgICAgICAgICAgIGlzU2VsZWN0OiAnJywKICAgICAgICAgICAgdm90ZUlkOiAnJywKICAgICAgICAgICAgdm90ZToge30sCiAgICAgICAgICAgIGRlc2NyaXB0aW9uSW1nVXJsOiAnJywKICAgICAgICAgICAgYWN0aXZlOiAwLAogICAgICAgICAgICBvcHRpb25MaXN0OiBbXSwKICAgICAgICAgICAgb3B0aW9uTGlzdFNvcnQ6IFtdLAogICAgICAgICAgICBvbmNlVm90ZU51bTogJycsCiAgICAgICAgICAgIGF2YXRhclVybDonJwogICAgICAgIH0KICAgIH0sCiAgICBtZXRob2RzOiB7CiAgICAgICAgYXN5bmMgZ2V0Vm90ZSh2b3RlSWQpIHsKICAgICAgICAgICAgbGV0IHRoYXQgPSB0aGlzOwogICAgICAgICAgICBsZXQgdXJsID0gdGhpcy53ZWJzaXRlKyIvdm90ZS9nZXRWb3RlQnlJZCIKICAgICAgICAgICAgYXdhaXQgdGhpcy5heGlvcy5nZXQodXJsLCB7CiAgICAgICAgICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgICAgICAgICAgICB2b3RlSWQ6IHZvdGVJZAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuY29kZSA9PSAyMDApIHsKICAgICAgICAgICAgICAgICAgICB0aGF0LnZvdGUgPSByZXNwb25zZS5kYXRhLmRhdGE7CiAgICAgICAgICAgICAgICAgICAgLy8gY29uc29sZS5sb2codGhhdC52b3RlKTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIuaKleelqOS/oeaBr+afpeivouWksei0pSIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7CiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZQogICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTsKICAgICAgICAgICAgfSkKICAgICAgICB9LAogICAgICAgIGFzeW5jIGdldE9wdGlvbih2b3RlSWQpIHsKICAgICAgICAgICAgbGV0IHRoYXQgPSB0aGlzOwogICAgICAgICAgICBsZXQgdXJsID0gdGhpcy53ZWJzaXRlKyIvb3B0aW9uL2dldE9wdGlvbiIKICAgICAgICAgICAgYXdhaXQgdGhpcy5heGlvcy5nZXQodXJsLCB7CiAgICAgICAgICAgICAgICBwYXJhbXM6IHsKICAgICAgICAgICAgICAgICAgICB2b3RlSWQ6IHZvdGVJZAogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuY29kZSA9PSAyMDApIHsKICAgICAgICAgICAgICAgICAgICB0aGF0Lm9wdGlvbkxpc3QgPSByZXNwb25zZS5kYXRhLmRhdGE7CiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCLpgInpobnmn6Xor6LlpLHotKUiKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikgewogICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGUKICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGVycik7CiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICBkb1ZvdGUoKSB7CiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMuaXNTZWxlY3QpCiAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHRoaXMub25jZVZvdGVOdW0pCiAgICAgICAgICAgIGlmKHRoaXMuaXNMb2dpbj09ZmFsc2UpewogICAgICAgICAgICAgICAgdGhpcy4kZGlhbG9nLmNvbmZpcm0oewogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICfnmbvlvZXkuYvlkI7miY3og73ov5vooYzmipXnpajvvIzngrnlh7vnoa7orqTnq4vljbPliY3lvoDnmbvlvZUnCiAgICAgICAgICAgICAgICB9KS50aGVuKCgpID0+IHsKICAgICAgICAgICAgICAgICAgICAvLyBvbiBjb25maXJtCiAgICAgICAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSAnL2xvZ2luJzsKICAgICAgICAgICAgICAgIH0pLmNhdGNoKCgpID0+IHsKICAgICAgICAgICAgICAgICAgICAvLyBvbiBjYW5jZWwKICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICB9ZWxzZSB7CiAgICAgICAgICAgICAgICBpZih0aGlzLmlzU2VsZWN0PT0nJyl7CiAgICAgICAgICAgICAgICAgICAgdGhpcy4kZGlhbG9nLmFsZXJ0KHsKICAgICAgICAgICAgICAgICAgICAgICAgbWVzc2FnZTogJ+ivt+mAieaLqeS4gOmhuScKICAgICAgICAgICAgICAgICAgICB9KS50aGVuKCgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgLy8gb24gY2xvc2UKICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgIH1lbHNlewogICAgICAgICAgICAgICAgICAgIGxldCB1cGRhdGVWb3RlclVybD10aGlzLndlYnNpdGUrIi92b3RlL2RvVm90ZSI7CiAgICAgICAgICAgICAgICAgICAgbGV0IGNvbmZpZyA9IHsKICAgICAgICAgICAgICAgICAgICAgICAgaGVhZGVyczogeyAvL+a3u+WKoOivt+axguWktAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9OwogICAgICAgICAgICAgICAgICAgIGxldCBwYXJhbXMgPSBuZXcgRm9ybURhdGEoKTsgLy/liJvlu7pmb3Jt5a+56LGhCiAgICAgICAgICAgICAgICAgICAgcGFyYW1zLmFwcGVuZCgidXNlcklkIiwgdGhpcy5sb2dpblVzZXIuaWQpOwogICAgICAgICAgICAgICAgICAgIHBhcmFtcy5hcHBlbmQoInZvdGVJZCIsIHRoaXMudm90ZUlkKTsKICAgICAgICAgICAgICAgICAgICBwYXJhbXMuYXBwZW5kKCJvcHRpb25JZCIsIHRoaXMuaXNTZWxlY3QpOwogICAgICAgICAgICAgICAgICAgIHBhcmFtcy5hcHBlbmQoInZvdGVOdW0iLCB0aGlzLm9uY2VWb3RlTnVtKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLmF4aW9zLnB1dCh1cGRhdGVWb3RlclVybCxwYXJhbXMsY29uZmlnKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5jb2RlID09IDIwMCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kZGlhbG9nLmFsZXJ0KHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAn5oqV56Wo5oiQ5YqfJwogICAgICAgICAgICAgICAgICAgICAgICAgICAgfSkudGhlbigoKSA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gb24gY2xvc2UKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9ICcvZGV0YWlsJzsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIuaKleelqOS/oeaBr+S/ruaUueaIkOWKnyIpOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIuaKleelqOS/oeaBr+S/ruaUueWksei0pSIpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikgewogICAgICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpOwogICAgICAgICAgICAgICAgICAgIH0pCgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfQogICAgfSwKICAgIGFzeW5jIG1vdW50ZWQoKSB7CiAgICAgICAgLy8gdGhpcy52b3RlSWQgPSB0aGlzLiRyb3V0ZS5wYXJhbXMudm90ZUlkOwogICAgICAgIHRoaXMudm90ZUlkPXRoaXMuJHJvdXRlLnF1ZXJ5LnZvdGVJZDsKICAgICAgICBhd2FpdCB0aGlzLmdldFZvdGUodGhpcy52b3RlSWQpOwogICAgICAgIGF3YWl0IHRoaXMuZ2V0T3B0aW9uKHRoaXMudm90ZUlkKTsKICAgICAgICBmb3IgKGxldCBpIGluIHRoaXMub3B0aW9uTGlzdCkgewogICAgICAgICAgICB0aGlzLm9wdGlvbkxpc3RTb3J0W2ldID0gdGhpcy5vcHRpb25MaXN0W2ldOwogICAgICAgIH0KICAgICAgICAvLyB0aGlzLmRlc2NyaXB0aW9uSW1nVXJsPSdEOi91cGxvYWRGaWxlcy8nK3RoaXMudm90ZS5kZXNjcmlwdGlvbkltZzsKICAgICAgICBsZXQgdm90ZVN1bSA9IDA7CiAgICAgICAgZm9yIChsZXQgaSBpbiB0aGlzLm9wdGlvbkxpc3QpIHsKICAgICAgICAgICAgdm90ZVN1bSArPSB0aGlzLm9wdGlvbkxpc3RbaV0udm90ZXM7CiAgICAgICAgICAgIHRoaXMub3B0aW9uTGlzdFtpXS5pbWc9dGhpcy5pbWdVcmwrdGhpcy5vcHRpb25MaXN0W2ldLmltZzsKICAgICAgICB9CiAgICAgICAgZm9yIChsZXQgaSBpbiB0aGlzLm9wdGlvbkxpc3RTb3J0KSB7CiAgICAgICAgICAgIHRoaXMub3B0aW9uTGlzdFNvcnRbaV0uaW1nPXRoaXMuaW1nVXJsK3RoaXMub3B0aW9uTGlzdFNvcnRbaV0uaW1nOwogICAgICAgIH0KICAgICAgICBpZih2b3RlU3VtPT0wKXsKICAgICAgICAgICAgZm9yIChsZXQgaiBpbiB0aGlzLm9wdGlvbkxpc3QpIHsKICAgICAgICAgICAgICAgIHRoaXMub3B0aW9uTGlzdFtqXS5wZXJjZW50ID0gMDsKICAgICAgICAgICAgfQogICAgICAgIH1lbHNlIHsKICAgICAgICAgICAgZm9yIChsZXQgaiBpbiB0aGlzLm9wdGlvbkxpc3QpIHsKICAgICAgICAgICAgICAgIGxldCBhID0gKHRoaXMub3B0aW9uTGlzdFtqXS52b3RlcyAvIHZvdGVTdW0pICogMTAwOwogICAgICAgICAgICAgICAgdGhpcy5vcHRpb25MaXN0W2pdLnBlcmNlbnQgPSBhLnRvRml4ZWQoMik7CiAgICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgdGhpcy5vcHRpb25MaXN0LnNvcnQoZnVuY3Rpb24gKHgsIHkpIHsKICAgICAgICAgICAgaWYgKHguY29udGVudCA8IHkuY29udGVudCkgewogICAgICAgICAgICAgICAgcmV0dXJuIC0xOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICh4LmNvbnRlbnQgPiB5LmNvbnRlbnQpIHsKICAgICAgICAgICAgICAgIHJldHVybiAxOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0pCiAgICAgICAgdGhpcy5vcHRpb25MaXN0U29ydC5zb3J0KGZ1bmN0aW9uICh4LCB5KSB7CiAgICAgICAgICAgIGlmICh4LnZvdGVzIDwgeS52b3RlcykgewogICAgICAgICAgICAgICAgcmV0dXJuIDE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHgudm90ZXMgPiB5LnZvdGVzKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIDA7CiAgICAgICAgfSkKICAgICAgICAvKuiOt+WPluW9k+WJjeeZu+W9leeUqOaIt+S/oeaBryovCiAgICAgICAgaWYgKHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oImxvZ2luVXNlciIpICE9IG51bGwgfHwgbG9jYWxTdG9yYWdlLmdldEl0ZW0oImxvZ2luVXNlciIpICE9IG51bGwpIHsKICAgICAgICAgICAgdGhpcy5pc0xvZ2luID0gdHJ1ZTsKICAgICAgICAgICAgaWYgKHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oImxvZ2luVXNlciIpICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIHRoaXMubG9naW5Vc2VyID0gSlNPTi5wYXJzZShzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCJsb2dpblVzZXIiKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJsb2dpblVzZXIiKSAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICB0aGlzLmxvZ2luVXNlciA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oImxvZ2luVXNlciIpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICB0aGlzLmF2YXRhclVybD10aGlzLmltZ1VybCt0aGlzLmxvZ2luVXNlci5hdmF0YXI7CiAgICAgICAgdGhpcy5kZXNjcmlwdGlvbkltZ1VybD10aGlzLmltZ1VybCt0aGlzLnZvdGUuZGVzY3JpcHRpb25JbWc7CiAgICB9Cn0K"},{"version":3,"sources":["detail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"detail.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n    <div class=\"detail\">\r\n        <van-row>\r\n            <van-col span=\"2\">\r\n                <img id=\"titleImg\" src=\"../assets/images/h1.png\" height=\"24px\" width=\"24px\"/>\r\n            </van-col>\r\n            <van-col span=\"22\">\r\n                <span id=\"title\">{{vote.title}}</span>\r\n            </van-col>\r\n        </van-row>\r\n        <div class=\"d-flex\" id=\"creatorInfo\">\r\n            <van-image\r\n                    round\r\n                    fit=\"none\"\r\n                    width=\"3rem\"\r\n                    height=\"3rem\"\r\n                    :src=avatarUrl\r\n                    style=\"margin-right: 12px\"\r\n            />\r\n            <div>\r\n                <span id=\"s1\">投票发起人</span>\r\n                <span id=\"s2\">{{vote.creator.userName}}</span>\r\n            </div>\r\n        </div>\r\n        <div id=\"deadline\">截止时间：{{vote.deadline}}</div>\r\n        <div id=\"prompt\">(提示：点击选项可查看详情，投票结果于投票后可见)</div>\r\n        <hr>\r\n        <img :src=descriptionImgUrl>\r\n        <div class=\"description\" v-if=\"vote.description!=null\">{{vote.description}}</div>\r\n        <div class=\"description\" v-else>暂无说明</div>\r\n        <hr>\r\n        <van-tabs v-model=\"active\" id=\"tab1\">\r\n            <van-tab title=\"默认排序\" style=\"width: 400px\">\r\n                <div class=\"options d-flex\" v-for=\"(item,i) in optionList\" :key=i>\r\n                    <img height=\"64px\" width=\"64px\">\r\n                    <div class=\"option-content\">\r\n                        <div>{{item.content}}</div>\r\n                        <div class=\"d-flex justify-content-end\">\r\n                            <div class=\"progress\" style=\"width: 240px;margin-top: 8px\">\r\n                                <div class=\"progress-bar\" role=\"progressbar\" :style=\"{width: item.percent+'%'}\"\r\n                                     aria-valuenow=\"25\" aria-valuemin=\"0\" aria-valuemax=\"100\">{{item.percent}} %\r\n                                </div>\r\n                            </div>\r\n                            <div class=\"votenum\">{{item.votes}}票</div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </van-tab>\r\n            <van-tab title=\"票数排序\" style=\"width: 400px\">\r\n                <div class=\"options d-flex\" v-for=\"(item,i) in optionListSort\" :key=i>\r\n                    <img height=\"64px\" width=\"64px\">\r\n                    <div class=\"option-content\">\r\n                        <div>{{item.content}}</div>\r\n                        <div class=\"d-flex justify-content-end\">\r\n                            <div class=\"progress\" style=\"width: 240px;margin-top: 8px\">\r\n                                <div class=\"progress-bar\" role=\"progressbar\" :style=\"{width: item.percent+'%'}\"\r\n                                     aria-valuenow=\"25\" aria-valuemin=\"0\" aria-valuemax=\"100\">{{item.percent}} %\r\n                                </div>\r\n                            </div>\r\n                            <div class=\"votenum\">{{item.votes}}票</div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </van-tab>\r\n        </van-tabs>\r\n        <hr>\r\n        <van-tabs v-model=\"active\" id=\"tab2\">\r\n            <van-tab title=\"参与投票\" style=\"width: 400px\">\r\n                <van-radio-group v-model=\"isSelect\">\r\n                    <van-grid :border=\"false\" :column-num=\"2\">\r\n                        <van-grid-item v-for=\"(item,i) in optionList\" :key=i>\r\n                            <van-image\r\n                                    width=\"160\"\r\n                                    height=\"160\"\r\n                                    lazy-load\r\n                                    :src=item.img\r\n                                    fit=\"cover\"\r\n                                    style=\"margin: 5px\"\r\n                                    radius=\"5px\"\r\n                            />\r\n                            <div class=\"d-flex justify-content-start\" style=\"width: 160px\">\r\n                                <van-radio :name=item.id>{{item.content}}</van-radio>\r\n                            </div>\r\n                        </van-grid-item>\r\n                    </van-grid>\r\n                </van-radio-group>\r\n                <div class=\"d-flex justify-content-between\" style=\"margin: 8px\">\r\n                    <span>选择投票数</span>\r\n                    <van-stepper v-model=\"onceVoteNum\" integer :max=\"vote.onceMaxVote\"/>\r\n                </div>\r\n            </van-tab>\r\n        </van-tabs>\r\n\r\n        <div class=\"d-flex justify-content-center\">\r\n            <van-button class=\"votebutton\" type=\"info\" @click=\"doVote()\">投票</van-button>\r\n        </div>\r\n        <div class=\"d-flex justify-content-center\">\r\n            <van-button class=\"votebutton\" plain type=\"info\">分享投票</van-button>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    export default {\r\n        name: \"detail\",\r\n        data() {\r\n            return {\r\n                isLogin:false,\r\n                loginUser:{},\r\n                isSelect: '',\r\n                voteId: '',\r\n                vote: {},\r\n                descriptionImgUrl: '',\r\n                active: 0,\r\n                optionList: [],\r\n                optionListSort: [],\r\n                onceVoteNum: '',\r\n                avatarUrl:''\r\n            }\r\n        },\r\n        methods: {\r\n            async getVote(voteId) {\r\n                let that = this;\r\n                let url = this.website+\"/vote/getVoteById\"\r\n                await this.axios.get(url, {\r\n                    params: {\r\n                        voteId: voteId\r\n                    }\r\n                }).then(function (response) {\r\n                    if (response.data.code == 200) {\r\n                        that.vote = response.data.data;\r\n                        // console.log(that.vote);\r\n                    } else {\r\n                        console.log(\"投票信息查询失败\");\r\n                    }\r\n                }).catch(function (err) {\r\n                    // eslint-disable-next-line no-console\r\n                    console.log(err);\r\n                })\r\n            },\r\n            async getOption(voteId) {\r\n                let that = this;\r\n                let url = this.website+\"/option/getOption\"\r\n                await this.axios.get(url, {\r\n                    params: {\r\n                        voteId: voteId\r\n                    }\r\n                }).then(function (response) {\r\n                    if (response.data.code == 200) {\r\n                        that.optionList = response.data.data;\r\n                    } else {\r\n                        console.log(\"选项查询失败\");\r\n                    }\r\n                }).catch(function (err) {\r\n                    // eslint-disable-next-line no-console\r\n                    console.log(err);\r\n                })\r\n            },\r\n            doVote() {\r\n                // console.log(this.isSelect)\r\n                // console.log(this.onceVoteNum)\r\n                if(this.isLogin==false){\r\n                    this.$dialog.confirm({\r\n                        message: '登录之后才能进行投票，点击确认立即前往登录'\r\n                    }).then(() => {\r\n                        // on confirm\r\n                        window.location.href = '/login';\r\n                    }).catch(() => {\r\n                        // on cancel\r\n                    });\r\n                }else {\r\n                    if(this.isSelect==''){\r\n                        this.$dialog.alert({\r\n                            message: '请选择一项'\r\n                        }).then(() => {\r\n                            // on close\r\n                        });\r\n                    }else{\r\n                        let updateVoterUrl=this.website+\"/vote/doVote\";\r\n                        let config = {\r\n                            headers: { //添加请求头\r\n                                \"Content-Type\": \"application/x-www-form-urlencoded\"\r\n                            }\r\n                        };\r\n                        let params = new FormData(); //创建form对象\r\n                        params.append(\"userId\", this.loginUser.id);\r\n                        params.append(\"voteId\", this.voteId);\r\n                        params.append(\"optionId\", this.isSelect);\r\n                        params.append(\"voteNum\", this.onceVoteNum);\r\n                        this.axios.put(updateVoterUrl,params,config).then(function (response) {\r\n                            if (response.data.code == 200) {\r\n                                this.$dialog.alert({\r\n                                    message: '投票成功'\r\n                                }).then(() => {\r\n                                    // on close\r\n                                    window.location.href = '/detail';\r\n                                });\r\n                                console.log(\"投票信息修改成功\");\r\n                            } else {\r\n                                console.log(\"投票信息修改失败\");\r\n                            }\r\n                        }).catch(function (err) {\r\n                            console.log(err);\r\n                        })\r\n\r\n                    }\r\n                }\r\n            }\r\n        },\r\n        async mounted() {\r\n            // this.voteId = this.$route.params.voteId;\r\n            this.voteId=this.$route.query.voteId;\r\n            await this.getVote(this.voteId);\r\n            await this.getOption(this.voteId);\r\n            for (let i in this.optionList) {\r\n                this.optionListSort[i] = this.optionList[i];\r\n            }\r\n            // this.descriptionImgUrl='D:/uploadFiles/'+this.vote.descriptionImg;\r\n            let voteSum = 0;\r\n            for (let i in this.optionList) {\r\n                voteSum += this.optionList[i].votes;\r\n                this.optionList[i].img=this.imgUrl+this.optionList[i].img;\r\n            }\r\n            for (let i in this.optionListSort) {\r\n                this.optionListSort[i].img=this.imgUrl+this.optionListSort[i].img;\r\n            }\r\n            if(voteSum==0){\r\n                for (let j in this.optionList) {\r\n                    this.optionList[j].percent = 0;\r\n                }\r\n            }else {\r\n                for (let j in this.optionList) {\r\n                    let a = (this.optionList[j].votes / voteSum) * 100;\r\n                    this.optionList[j].percent = a.toFixed(2);\r\n                }\r\n            }\r\n            this.optionList.sort(function (x, y) {\r\n                if (x.content < y.content) {\r\n                    return -1;\r\n                }\r\n                if (x.content > y.content) {\r\n                    return 1;\r\n                }\r\n                return 0;\r\n            })\r\n            this.optionListSort.sort(function (x, y) {\r\n                if (x.votes < y.votes) {\r\n                    return 1;\r\n                }\r\n                if (x.votes > y.votes) {\r\n                    return -1;\r\n                }\r\n                return 0;\r\n            })\r\n            /*获取当前登录用户信息*/\r\n            if (sessionStorage.getItem(\"loginUser\") != null || localStorage.getItem(\"loginUser\") != null) {\r\n                this.isLogin = true;\r\n                if (sessionStorage.getItem(\"loginUser\") != null) {\r\n                    this.loginUser = JSON.parse(sessionStorage.getItem(\"loginUser\"));\r\n                }\r\n                if (localStorage.getItem(\"loginUser\") != null) {\r\n                    this.loginUser = JSON.parse(localStorage.getItem(\"loginUser\"));\r\n                }\r\n            }\r\n            this.avatarUrl=this.imgUrl+this.loginUser.avatar;\r\n            this.descriptionImgUrl=this.imgUrl+this.vote.descriptionImg;\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n    .detail {\r\n        margin-top: 30px;\r\n        margin-bottom: 90px;\r\n    }\r\n\r\n    .detail img {\r\n        margin: 8px 8px;\r\n    }\r\n\r\n    .description {\r\n        margin: 8px 8px;\r\n        font-size: small;\r\n    }\r\n\r\n    .options {\r\n        margin: 3px 8px;\r\n    }\r\n\r\n    .option-content {\r\n        margin: 8px 8px;\r\n    }\r\n\r\n    .votenum {\r\n        margin: 3px;\r\n    }\r\n\r\n    .votebutton {\r\n        width: 160px;\r\n        display: block;\r\n        margin-top: 12px;\r\n\r\n    }\r\n\r\n    #titleImg {\r\n        margin-left: 8px;\r\n        margin-top: 6px\r\n    }\r\n\r\n    #title {\r\n        display: block;\r\n        margin: 6px 0px\r\n    }\r\n\r\n    #creatorInfo {\r\n        margin: 5px 8px\r\n    }\r\n\r\n    #creatorInfo #s1 {\r\n        color: #969799;\r\n        display: block;\r\n        font-size: x-small;\r\n        margin-top: 3px\r\n    }\r\n\r\n    #creatorInfo #s1 {\r\n        display: block;\r\n    }\r\n\r\n    #deadline {\r\n        font-size: x-small;\r\n        margin-left: 8px;\r\n    }\r\n\r\n    #prompt {\r\n        font-size: x-small;\r\n        color: #969799;\r\n        margin-left: 8px;\r\n        margin-bottom: 8px;\r\n    }\r\n\r\n    #tab1 {\r\n        width: 160px;\r\n    }\r\n\r\n    #tab2 {\r\n        width: 80px;\r\n    }\r\n\r\n    hr {\r\n        margin: 0px 8px;\r\n        border: 0;\r\n        color: #e0e0e0;\r\n        background-color: #e0e0e0;\r\n        height: 1px\r\n    }\r\n</style>"]}]}