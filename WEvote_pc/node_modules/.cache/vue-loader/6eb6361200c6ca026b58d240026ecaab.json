{"remainingRequest":"C:\\Users\\Ray\\WebstormProjects\\vote_app3\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Ray\\WebstormProjects\\vote_app3\\src\\components\\account\\accountIndex.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Ray\\WebstormProjects\\vote_app3\\src\\components\\account\\accountIndex.vue","mtime":1577873588978},{"path":"C:\\Users\\Ray\\WebstormProjects\\vote_app3\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Ray\\WebstormProjects\\vote_app3\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Ray\\WebstormProjects\\vote_app3\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Ray\\WebstormProjects\\vote_app3\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICAgIG5hbWU6ICJhY2NvdW50SW5kZXgiLAogICAgZGF0YSgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICB0YWJsZURhdGE6IFtdLAogICAgICAgICAgICBpc0xvZ2luOiBmYWxzZSwKICAgICAgICAgICAgbG9naW5Vc2VyOiB7fSwKICAgICAgICAgICAgdm90ZUxpc3Q6IFtdCiAgICAgICAgfQogICAgfSwKICAgIG1ldGhvZHM6IHsKICAgICAgICBnZXRWb3RlTGlzdCgpIHsKICAgICAgICAgICAgbGV0IHRoYXQgPSB0aGlzOwogICAgICAgICAgICBsZXQgdXJsID0gdGhpcy53ZWJzaXRlICsgIi92b3RlL2dldFZvdGUiOwogICAgICAgICAgICB0aGlzLmF4aW9zLmdldCh1cmwsIHsKICAgICAgICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICAgICAgICAgIGNyZWF0b3JJZDogdGhpcy5sb2dpblVzZXIuaWQKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkudGhlbihhc3luYyBmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLmNvZGUgPT0gMjAwKSB7CiAgICAgICAgICAgICAgICAgICAgbGV0IHJlc3VsdExpc3QgPSByZXNwb25zZS5kYXRhLmRhdGE7CiAgICAgICAgICAgICAgICAgICAgZm9yIChsZXQgaSBpbiByZXN1bHRMaXN0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdExpc3RbaV0udmlkID0gcGFyc2VJbnQoaSkgKyAxOwogICAgICAgICAgICAgICAgICAgICAgICByZXN1bHRMaXN0W2ldLmlzRGVhZCA9IHRoYXQuY29tcGFyZVRpbWUocmVzdWx0TGlzdFtpXS5kZWFkbGluZSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdExpc3RbaV0ub3B0aW9uTnVtID0gYXdhaXQgdGhhdC5nZXRPcHRpb25OdW0ocmVzdWx0TGlzdFtpXS5pZCk7CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChyZXN1bHRMaXN0W2ldLnZvdGVyICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdExpc3RbaV0ucGFydG5lck51bSA9IHJlc3VsdExpc3RbaV0udm90ZXIubGVuZ3RoOwogICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVzdWx0TGlzdFtpXS5wYXJ0bmVyTnVtID0gMDsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVzdWx0TGlzdFtpXS5mbGFnID09IDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlc3VsdExpc3Quc3BsaWNlKGksIDEpOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHRoYXQudm90ZUxpc3QgPSByZXN1bHRMaXN0OwogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHRoYXQudm90ZUxpc3QpCiAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCLmn6Xor6LlpLHotKUiKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGUKICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKGVycik7CiAgICAgICAgICAgIH0pCiAgICAgICAgfSwKICAgICAgICBhc3luYyBnZXRPcHRpb25OdW0odm90ZUlkKSB7CiAgICAgICAgICAgIGxldCBvcHRpb25OdW0gPSAwOwogICAgICAgICAgICBsZXQgdXJsID0gdGhpcy53ZWJzaXRlICsgIi9vcHRpb24vZ2V0T3B0aW9uTnVtIgogICAgICAgICAgICBhd2FpdCB0aGlzLmF4aW9zLmdldCh1cmwsIHsKICAgICAgICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICAgICAgICAgIHZvdGVJZDogdm90ZUlkCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKHJlc3BvbnNlKSB7CiAgICAgICAgICAgICAgICBpZiAocmVzcG9uc2UuZGF0YS5jb2RlID09IDIwMCkgewogICAgICAgICAgICAgICAgICAgIG9wdGlvbk51bSA9IHJlc3BvbnNlLmRhdGEuZGF0YTsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhvcHRpb25OdW0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygi5p+l6K+i5aSx6LSlIik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlCiAgICAgICAgICAgICAgICAvLyBjb25zb2xlLmxvZyhlcnIpOwogICAgICAgICAgICB9KQogICAgICAgICAgICByZXR1cm4gb3B0aW9uTnVtOwogICAgICAgIH0sCiAgICAgICAgY29tcGFyZVRpbWUoZGF0ZUZvcm1hdCkgewogICAgICAgICAgICBsZXQgZGF0ZSA9IG5ldyBEYXRlKGRhdGVGb3JtYXQpOwogICAgICAgICAgICBsZXQgbm93RGF0ZSA9IG5ldyBEYXRlKCk7CiAgICAgICAgICAgIGlmIChkYXRlLmdldFRpbWUoKSA+IG5vd0RhdGUuZ2V0VGltZSgpKSB7CiAgICAgICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgdG9jcmVhdGVWb3RlKCkgewogICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7bmFtZTonY3JlYXRlVm90ZSd9KQogICAgICAgIH0sCiAgICAgICAgdG92b3RlTGlzdCgpewogICAgICAgICAgICB0aGlzLiRyb3V0ZXIucHVzaCh7bmFtZTondm90ZUxpc3QnfSkKICAgICAgICB9CiAgICB9LAogICAgYXN5bmMgbW91bnRlZCgpIHsKICAgICAgICBpZiAoc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgibG9naW5Vc2VyIikgIT0gbnVsbCB8fCBsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgibG9naW5Vc2VyIikgIT0gbnVsbCkgewogICAgICAgICAgICB0aGlzLmlzTG9naW4gPSB0cnVlOwogICAgICAgICAgICBpZiAoc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgibG9naW5Vc2VyIikgIT0gbnVsbCkgewogICAgICAgICAgICAgICAgdGhpcy5sb2dpblVzZXIgPSBKU09OLnBhcnNlKHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oImxvZ2luVXNlciIpKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAobG9jYWxTdG9yYWdlLmdldEl0ZW0oImxvZ2luVXNlciIpICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIHRoaXMubG9naW5Vc2VyID0gSlNPTi5wYXJzZShsb2NhbFN0b3JhZ2UuZ2V0SXRlbSgibG9naW5Vc2VyIikpOwogICAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIC8vIHRoaXMubG9naW5Vc2VyPXRoaXMuJHJvdXRlLnBhcmFtcy5sb2dpblVzZXI7CiAgICAgICAgdGhpcy5nZXRWb3RlTGlzdCgpOwoKICAgIH0KfQo="},{"version":3,"sources":["accountIndex.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA","file":"accountIndex.vue","sourceRoot":"src/components/account","sourcesContent":["<template>\r\n    <div>\r\n        <h1 class=\"page-header text-overflow\">用户首页</h1>\r\n        <ol class=\"breadcrumb\">\r\n            <li>用户中心</li>\r\n            <li><i class=\"el-icon-arrow-right\"></i>用户首页</li>\r\n        </ol>\r\n        <div class=\"card mycard\">\r\n            <h5 class=\"card-header\">最近的投票</h5>\r\n            <div class=\"card-body\">\r\n                <el-button type=\"primary\" icon=\"el-icon-edit\" size=\"small \" @click=\"tocreateVote\">创建投票</el-button>\r\n                <el-button type=\"success\" icon=\"el-icon-s-fold\" size=\"small \" @click=\"tovoteList\">管理投票</el-button>\r\n                <el-table\r\n                        :data=\"voteList\"\r\n                        stripe\r\n                        style=\"width: 100%\"\r\n                        type=index>\r\n                    <el-table-column\r\n                            prop=\"vid\"\r\n                            label=\"序号\"\r\n                            width=\"80\">\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            prop=\"title\"\r\n                            label=\"标题\"\r\n                            width=\"180\">\r\n                    </el-table-column>\r\n                    <el-table-column label=\"状态\" width=\"120\">\r\n                        <template slot-scope=\"scope\">\r\n                            <span v-if=\"scope.row.isDead\" class=\"badge badge-pill badge-success\">进行中</span>\r\n                            <span v-else class=\"badge badge-pill badge-danger\">已结束</span>\r\n                        </template>\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            prop=\"optionNum\"\r\n                            label=\"选项数量\"\r\n                            width=\"100\">\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            prop=\"partnerNum\"\r\n                            label=\"参与人数\"\r\n                            width=\"100\">\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            prop=\"deadline\"\r\n                            label=\"结束时间\"\r\n                            width=\"200\">\r\n                    </el-table-column>\r\n                </el-table>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"card mycard\">\r\n            <h5 class=\"card-header\">最新公告</h5>\r\n            <div class=\"card-body\">\r\n                <el-table\r\n                        :data=\"tableData\"\r\n                        style=\"width: 100%\">\r\n                    <el-table-column\r\n                            prop=\"date\"\r\n                            label=\"序号\"\r\n                            width=\"60\">\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            prop=\"name\"\r\n                            label=\"标题\"\r\n                            width=\"960\">\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            prop=\"address\"\r\n                            label=\"时间\">\r\n                    </el-table-column>\r\n                </el-table>\r\n            </div>\r\n        </div>\r\n\r\n    </div>\r\n</template>\r\n<script>\r\n    export default {\r\n        name: \"accountIndex\",\r\n        data() {\r\n            return {\r\n                tableData: [],\r\n                isLogin: false,\r\n                loginUser: {},\r\n                voteList: []\r\n            }\r\n        },\r\n        methods: {\r\n            getVoteList() {\r\n                let that = this;\r\n                let url = this.website + \"/vote/getVote\";\r\n                this.axios.get(url, {\r\n                    params: {\r\n                        creatorId: this.loginUser.id\r\n                    }\r\n                }).then(async function (response) {\r\n                    if (response.data.code == 200) {\r\n                        let resultList = response.data.data;\r\n                        for (let i in resultList) {\r\n                            resultList[i].vid = parseInt(i) + 1;\r\n                            resultList[i].isDead = that.compareTime(resultList[i].deadline);\r\n                            resultList[i].optionNum = await that.getOptionNum(resultList[i].id);\r\n                            if (resultList[i].voter != null) {\r\n                                resultList[i].partnerNum = resultList[i].voter.length;\r\n                            } else {\r\n                                resultList[i].partnerNum = 0;\r\n                            }\r\n                            if (resultList[i].flag == 1) {\r\n                                resultList.splice(i, 1);\r\n                            }\r\n                        }\r\n                        that.voteList = resultList;\r\n                        console.log(that.voteList)\r\n                    } else {\r\n                        console.log(\"查询失败\");\r\n                    }\r\n                }).catch(function () {\r\n                    // eslint-disable-next-line no-console\r\n                    // console.log(err);\r\n                })\r\n            },\r\n            async getOptionNum(voteId) {\r\n                let optionNum = 0;\r\n                let url = this.website + \"/option/getOptionNum\"\r\n                await this.axios.get(url, {\r\n                    params: {\r\n                        voteId: voteId\r\n                    }\r\n                }).then(function (response) {\r\n                    if (response.data.code == 200) {\r\n                        optionNum = response.data.data;\r\n                        console.log(optionNum);\r\n                    } else {\r\n                        console.log(\"查询失败\");\r\n                    }\r\n                }).catch(function () {\r\n                    // eslint-disable-next-line no-console\r\n                    // console.log(err);\r\n                })\r\n                return optionNum;\r\n            },\r\n            compareTime(dateFormat) {\r\n                let date = new Date(dateFormat);\r\n                let nowDate = new Date();\r\n                if (date.getTime() > nowDate.getTime()) {\r\n                    return true;\r\n                } else {\r\n                    return false;\r\n                }\r\n            },\r\n            tocreateVote() {\r\n                this.$router.push({name:'createVote'})\r\n            },\r\n            tovoteList(){\r\n                this.$router.push({name:'voteList'})\r\n            }\r\n        },\r\n        async mounted() {\r\n            if (sessionStorage.getItem(\"loginUser\") != null || localStorage.getItem(\"loginUser\") != null) {\r\n                this.isLogin = true;\r\n                if (sessionStorage.getItem(\"loginUser\") != null) {\r\n                    this.loginUser = JSON.parse(sessionStorage.getItem(\"loginUser\"));\r\n                }\r\n                if (localStorage.getItem(\"loginUser\") != null) {\r\n                    this.loginUser = JSON.parse(localStorage.getItem(\"loginUser\"));\r\n                }\r\n            }\r\n            // this.loginUser=this.$route.params.loginUser;\r\n            this.getVoteList();\r\n\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n    .mycard {\r\n        margin-top: 30px\r\n    }\r\n</style>"]}]}