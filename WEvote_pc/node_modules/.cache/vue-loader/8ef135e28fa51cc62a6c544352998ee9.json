{"remainingRequest":"C:\\Users\\Ray\\WebstormProjects\\vote_app3\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Ray\\WebstormProjects\\vote_app3\\src\\components\\account\\accountIndex.vue?vue&type=style&index=0&id=ffcc9052&scoped=true&lang=css&","dependencies":[{"path":"C:\\Users\\Ray\\WebstormProjects\\vote_app3\\src\\components\\account\\accountIndex.vue","mtime":1577873588978},{"path":"C:\\Users\\Ray\\WebstormProjects\\vote_app3\\node_modules\\css-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Ray\\WebstormProjects\\vote_app3\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":499162500000},{"path":"C:\\Users\\Ray\\WebstormProjects\\vote_app3\\node_modules\\postcss-loader\\src\\index.js","mtime":499162500000},{"path":"C:\\Users\\Ray\\WebstormProjects\\vote_app3\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Ray\\WebstormProjects\\vote_app3\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLm15Y2FyZCB7CiAgICBtYXJnaW4tdG9wOiAzMHB4Cn0K"},{"version":3,"sources":["accountIndex.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAiLA;AACA;AACA","file":"accountIndex.vue","sourceRoot":"src/components/account","sourcesContent":["<template>\r\n    <div>\r\n        <h1 class=\"page-header text-overflow\">用户首页</h1>\r\n        <ol class=\"breadcrumb\">\r\n            <li>用户中心</li>\r\n            <li><i class=\"el-icon-arrow-right\"></i>用户首页</li>\r\n        </ol>\r\n        <div class=\"card mycard\">\r\n            <h5 class=\"card-header\">最近的投票</h5>\r\n            <div class=\"card-body\">\r\n                <el-button type=\"primary\" icon=\"el-icon-edit\" size=\"small \" @click=\"tocreateVote\">创建投票</el-button>\r\n                <el-button type=\"success\" icon=\"el-icon-s-fold\" size=\"small \" @click=\"tovoteList\">管理投票</el-button>\r\n                <el-table\r\n                        :data=\"voteList\"\r\n                        stripe\r\n                        style=\"width: 100%\"\r\n                        type=index>\r\n                    <el-table-column\r\n                            prop=\"vid\"\r\n                            label=\"序号\"\r\n                            width=\"80\">\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            prop=\"title\"\r\n                            label=\"标题\"\r\n                            width=\"180\">\r\n                    </el-table-column>\r\n                    <el-table-column label=\"状态\" width=\"120\">\r\n                        <template slot-scope=\"scope\">\r\n                            <span v-if=\"scope.row.isDead\" class=\"badge badge-pill badge-success\">进行中</span>\r\n                            <span v-else class=\"badge badge-pill badge-danger\">已结束</span>\r\n                        </template>\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            prop=\"optionNum\"\r\n                            label=\"选项数量\"\r\n                            width=\"100\">\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            prop=\"partnerNum\"\r\n                            label=\"参与人数\"\r\n                            width=\"100\">\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            prop=\"deadline\"\r\n                            label=\"结束时间\"\r\n                            width=\"200\">\r\n                    </el-table-column>\r\n                </el-table>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"card mycard\">\r\n            <h5 class=\"card-header\">最新公告</h5>\r\n            <div class=\"card-body\">\r\n                <el-table\r\n                        :data=\"tableData\"\r\n                        style=\"width: 100%\">\r\n                    <el-table-column\r\n                            prop=\"date\"\r\n                            label=\"序号\"\r\n                            width=\"60\">\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            prop=\"name\"\r\n                            label=\"标题\"\r\n                            width=\"960\">\r\n                    </el-table-column>\r\n                    <el-table-column\r\n                            prop=\"address\"\r\n                            label=\"时间\">\r\n                    </el-table-column>\r\n                </el-table>\r\n            </div>\r\n        </div>\r\n\r\n    </div>\r\n</template>\r\n<script>\r\n    export default {\r\n        name: \"accountIndex\",\r\n        data() {\r\n            return {\r\n                tableData: [],\r\n                isLogin: false,\r\n                loginUser: {},\r\n                voteList: []\r\n            }\r\n        },\r\n        methods: {\r\n            getVoteList() {\r\n                let that = this;\r\n                let url = this.website + \"/vote/getVote\";\r\n                this.axios.get(url, {\r\n                    params: {\r\n                        creatorId: this.loginUser.id\r\n                    }\r\n                }).then(async function (response) {\r\n                    if (response.data.code == 200) {\r\n                        let resultList = response.data.data;\r\n                        for (let i in resultList) {\r\n                            resultList[i].vid = parseInt(i) + 1;\r\n                            resultList[i].isDead = that.compareTime(resultList[i].deadline);\r\n                            resultList[i].optionNum = await that.getOptionNum(resultList[i].id);\r\n                            if (resultList[i].voter != null) {\r\n                                resultList[i].partnerNum = resultList[i].voter.length;\r\n                            } else {\r\n                                resultList[i].partnerNum = 0;\r\n                            }\r\n                            if (resultList[i].flag == 1) {\r\n                                resultList.splice(i, 1);\r\n                            }\r\n                        }\r\n                        that.voteList = resultList;\r\n                        console.log(that.voteList)\r\n                    } else {\r\n                        console.log(\"查询失败\");\r\n                    }\r\n                }).catch(function () {\r\n                    // eslint-disable-next-line no-console\r\n                    // console.log(err);\r\n                })\r\n            },\r\n            async getOptionNum(voteId) {\r\n                let optionNum = 0;\r\n                let url = this.website + \"/option/getOptionNum\"\r\n                await this.axios.get(url, {\r\n                    params: {\r\n                        voteId: voteId\r\n                    }\r\n                }).then(function (response) {\r\n                    if (response.data.code == 200) {\r\n                        optionNum = response.data.data;\r\n                        console.log(optionNum);\r\n                    } else {\r\n                        console.log(\"查询失败\");\r\n                    }\r\n                }).catch(function () {\r\n                    // eslint-disable-next-line no-console\r\n                    // console.log(err);\r\n                })\r\n                return optionNum;\r\n            },\r\n            compareTime(dateFormat) {\r\n                let date = new Date(dateFormat);\r\n                let nowDate = new Date();\r\n                if (date.getTime() > nowDate.getTime()) {\r\n                    return true;\r\n                } else {\r\n                    return false;\r\n                }\r\n            },\r\n            tocreateVote() {\r\n                this.$router.push({name:'createVote'})\r\n            },\r\n            tovoteList(){\r\n                this.$router.push({name:'voteList'})\r\n            }\r\n        },\r\n        async mounted() {\r\n            if (sessionStorage.getItem(\"loginUser\") != null || localStorage.getItem(\"loginUser\") != null) {\r\n                this.isLogin = true;\r\n                if (sessionStorage.getItem(\"loginUser\") != null) {\r\n                    this.loginUser = JSON.parse(sessionStorage.getItem(\"loginUser\"));\r\n                }\r\n                if (localStorage.getItem(\"loginUser\") != null) {\r\n                    this.loginUser = JSON.parse(localStorage.getItem(\"loginUser\"));\r\n                }\r\n            }\r\n            // this.loginUser=this.$route.params.loginUser;\r\n            this.getVoteList();\r\n\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n    .mycard {\r\n        margin-top: 30px\r\n    }\r\n</style>"]}]}