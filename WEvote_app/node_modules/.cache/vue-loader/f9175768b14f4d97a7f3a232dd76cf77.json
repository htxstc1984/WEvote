{"remainingRequest":"C:\\Users\\Ray\\WebstormProjects\\vote_app4\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\Ray\\WebstormProjects\\vote_app4\\src\\views\\newImageVote.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\Ray\\WebstormProjects\\vote_app4\\src\\views\\newImageVote.vue","mtime":1577871510526},{"path":"C:\\Users\\Ray\\WebstormProjects\\vote_app4\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Ray\\WebstormProjects\\vote_app4\\node_modules\\thread-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Ray\\WebstormProjects\\vote_app4\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Ray\\WebstormProjects\\vote_app4\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Ray\\WebstormProjects\\vote_app4\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICAgIG5hbWU6ICJuZXdJbWFnZVZvdGUiLAogICAgZGF0YSgpIHsKICAgICAgICByZXR1cm4gewogICAgICAgICAgICBtYXhzaXplOjEwMDAwMDAsCiAgICAgICAgICAgIGlzTG9naW46IGZhbHNlLAogICAgICAgICAgICBsb2dpblVzZXI6IHt9LAogICAgICAgICAgICB0aW1lU2hvdzE6IGZhbHNlLAogICAgICAgICAgICB0aW1lU2hvdzI6IGZhbHNlLAogICAgICAgICAgICB2b3RlVGlsdGU6ICcnLAogICAgICAgICAgICBvcHRpb25MaXN0OiBbewogICAgICAgICAgICAgICAgaW1nOiBbXSwKICAgICAgICAgICAgICAgIGNvbnRlbnQ6ICcnCiAgICAgICAgICAgIH0sIHsKICAgICAgICAgICAgICAgIGltZzogW10sCiAgICAgICAgICAgICAgICBjb250ZW50OiAnJwogICAgICAgICAgICB9CiAgICAgICAgICAgIF0sCiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiAnJywKICAgICAgICAgICAgLy/nroDku4vlm77niYcKICAgICAgICAgICAgZGVzY3JpcHRpb25JbWdMaXN0OiBbXSwKICAgICAgICAgICAgLy/liIbkuqvlm77niYcKICAgICAgICAgICAgc2hhcmVJbWc6IFtdLAogICAgICAgICAgICBtYXhWb3RlOiAnJywKICAgICAgICAgICAgdGltZVNldDogewogICAgICAgICAgICAgICAgbWluRGF0ZTogbmV3IERhdGUoKSwKICAgICAgICAgICAgICAgIG1heERhdGU6IG5ldyBEYXRlKDIxMDAsIDExLCAzMSksCiAgICAgICAgICAgICAgICBjdXJyZW50RGF0ZTogbmV3IERhdGUoKQogICAgICAgICAgICB9LAogICAgICAgICAgICBzdGFydFRpbWU6IG5ldyBEYXRlKCkuZm9ybWF0KCJ5eXl5LU1NLWRkIGhoOm1tIiksCiAgICAgICAgICAgIGRlYWRsaW5lOiAnJywKICAgICAgICAgICAgbmV3Vm90ZToge30sCiAgICAgICAgfQogICAgfSwKICAgIG1ldGhvZHM6IHsKCiAgICAgICAgLy8gYWZ0ZXJSZWFkKGZpbGUpIHsKICAgICAgICAvLyAgICAgY29uc29sZS5sb2coZmlsZSkKICAgICAgICAvLyB9LAogICAgICAgIC8vIHRlc3QoKXsKICAgICAgICAvLyAgICAgdGhpcy4kbm90aWZ5KHsKICAgICAgICAvLyAgICAgICAgIG1lc3NhZ2U6ICflm77niYfkuIrkvKDlpLHotKUnLAogICAgICAgIC8vICAgICAgICAgZHVyYXRpb246IDEwMDAKICAgICAgICAvLyAgICAgfSk7CiAgICAgICAgLy8gfSwKICAgICAgICBvdmVyc2l6ZShmaWxlKXsKICAgICAgICAgICAgY29uc29sZS5sb2coZmlsZSkKICAgICAgICAgICAgdGhpcy4kZGlhbG9nLmFsZXJ0KHsKICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICflm77niYflpKflsI/kuI3og73otoXov4cxTScKICAgICAgICAgICAgfSkudGhlbigoKSA9PiB7CiAgICAgICAgICAgICAgICAvLyBvbiBjbG9zZQogICAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgICAgIGNyZWF0ZVZvdGU6IGFzeW5jIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgaWYgKHRoaXMudm90ZVRpbHRlID09ICcnKSB7CiAgICAgICAgICAgICAgICB0aGlzLiRkaWFsb2cuYWxlcnQoewogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICfor7floavlhpnmoIfpopgnCiAgICAgICAgICAgICAgICB9KS50aGVuKCgpID0+IHsKICAgICAgICAgICAgICAgICAgICAvLyBvbiBjbG9zZQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSBpZiAodGhpcy5vcHRpb25MaXN0Lmxlbmd0aCA9PSAwKSB7CiAgICAgICAgICAgICAgICB0aGlzLiRkaWFsb2cuYWxlcnQoewogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICfor7foh7PlsJHmt7vliqDkuIDkuKrpgInpobknCiAgICAgICAgICAgICAgICB9KS50aGVuKCgpID0+IHsKICAgICAgICAgICAgICAgICAgICAvLyBvbiBjbG9zZQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBmb3IgKGxldCBpIGluIHRoaXMub3B0aW9uTGlzdCkgewogICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLm9wdGlvbkxpc3RbaV0uaW1nWzBdID09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy4kZGlhbG9nLmFsZXJ0KHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICfor7fkuIrkvKDpgInpobnlm77niYcnCiAgICAgICAgICAgICAgICAgICAgICAgIH0pLnRoZW4oKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAgICAgLy8gb24gY2xvc2UKICAgICAgICAgICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKHRoaXMub3B0aW9uTGlzdFtpXS5jb250ZW50ID09ICcnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuJGRpYWxvZy5hbGVydCh7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAn6K+35aGr5YaZ5qCH6aKY6YCJ6aG55YaF5a65JwogICAgICAgICAgICAgICAgICAgICAgICB9KS50aGVuKCgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIG9uIGNsb3NlCiAgICAgICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgLy/mo4Dmn6XmoIfpopjllK/kuIDmgKcKICAgICAgICAgICAgICAgIGxldCBpc0V4aXN0PWF3YWl0IHRoaXMuY2hlY2tUaXRsZSh0aGlzLnZvdGVUaWx0ZSk7CiAgICAgICAgICAgICAgICBpZiAoaXNFeGlzdCA9PSBmYWxzZSkgewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCLmoIfpopjlt7LlrZjlnKgiKTsKICAgICAgICAgICAgICAgICAgICB0aGlzLiRkaWFsb2cuYWxlcnQoewogICAgICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiAn6K+l5qCH6aKY5bey5a2Y5ZyoJwogICAgICAgICAgICAgICAgICAgIH0pLnRoZW4oKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICAvLyBvbiBjbG9zZQogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIHRoaXMuJHRvYXN0LmxvYWRpbmcoewogICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICfliJvlu7rkuK0uLi4nLAogICAgICAgICAgICAgICAgICAgIGZvcmJpZENsaWNrOiB0cnVlLAogICAgICAgICAgICAgICAgICAgIGR1cmF0aW9uOiAwLAogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgICAgICBsZXQgaXNVcGxvYWQgPSB0cnVlOwogICAgICAgICAgICAgICAgbGV0IGlzQ3JlYXRlVm90ZSA9IGZhbHNlOwogICAgICAgICAgICAgICAgbGV0IGlzU2F2ZU9wdGlvbiA9IGZhbHNlOwogICAgICAgICAgICAgICAgLy/lsIbmnIDlpKfmipXnpajmlbDpu5jorqTnva7kuLoxCiAgICAgICAgICAgICAgICBpZiAodGhpcy5tYXhWb3RlID09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLm1heFZvdGUgPSAxOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgbGV0IHZvdGUgPSB7CiAgICAgICAgICAgICAgICAgICAgY3JlYXRvcjogdGhpcy5sb2dpblVzZXIsCiAgICAgICAgICAgICAgICAgICAgdGl0bGU6IHRoaXMudm90ZVRpbHRlLAogICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiB0aGlzLmRlc2NyaXB0aW9uLAogICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uSW1nOiAiIiwKICAgICAgICAgICAgICAgICAgICBzaGFyZUltZzogIiIsCiAgICAgICAgICAgICAgICAgICAgc3RhcnRUaW1lOiB0aGlzLnN0YXJ0VGltZSwKICAgICAgICAgICAgICAgICAgICBkZWFkbGluZTogdGhpcy5kZWFkbGluZSwKICAgICAgICAgICAgICAgICAgICBvbmNlTWF4Vm90ZTogdGhpcy5tYXhWb3RlLAogICAgICAgICAgICAgICAgfTsKICAgICAgICAgICAgICAgIC8v5LiK5Lyg5Zu+54mHCiAgICAgICAgICAgICAgICBpZiAodGhpcy5kZXNjcmlwdGlvbkltZ0xpc3RbMF0gIT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgIC8v5ZCM5q2l5omn6KGMIOmcgOetieW+heaWh+S7tuS4iuS8oOWujOavlQogICAgICAgICAgICAgICAgICAgIHZvdGUuZGVzY3JpcHRpb25JbWcgPSBhd2FpdCB0aGlzLnVwbG9hZEltZyh0aGlzLmRlc2NyaXB0aW9uSW1nTGlzdFswXSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHZvdGUuZGVzY3JpcHRpb25JbWcgPT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgICAgICBpc1VwbG9hZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmICh0aGlzLnNoYXJlSW1nWzBdICE9IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICB2b3RlLnNoYXJlSW1nID0gYXdhaXQgdGhpcy51cGxvYWRJbWcodGhpcy5zaGFyZUltZ1swXSk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHZvdGUuc2hhcmVJbWcgPT0gbnVsbCkgewogICAgICAgICAgICAgICAgICAgICAgICBpc1VwbG9hZCA9IGZhbHNlOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKHZvdGUpCiAgICAgICAgICAgICAgICAvL+S/neWtmOaKleelqOS/oeaBrwogICAgICAgICAgICAgICAgaXNDcmVhdGVWb3RlPWF3YWl0IHRoaXMuc2F2ZVZvdGUodm90ZSk7CiAgICAgICAgICAgICAgICAvL+S/neWtmOmAiemhueS/oeaBrwogICAgICAgICAgICAgICAgZm9yIChsZXQgaSBpbiB0aGlzLm9wdGlvbkxpc3QpIHsKICAgICAgICAgICAgICAgICAgICBsZXQgaW1nTmFtZSA9IGF3YWl0IHRoaXMudXBsb2FkSW1nKHRoaXMub3B0aW9uTGlzdFtpXS5pbWdbMF0pOwogICAgICAgICAgICAgICAgICAgIGlmIChpbWdOYW1lID09IG51bGwpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaXNVcGxvYWQgPSBmYWxzZTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgaXNTYXZlT3B0aW9uPWF3YWl0IHRoaXMuc2F2ZU9wdGlvbihpbWdOYW1lLGkpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoaXNVcGxvYWQgPT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLiR0b2FzdC5jbGVhcigpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuJG5vdGlmeSh7CiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICflm77niYfkuIrkvKDlpLHotKUnLAogICAgICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogMTAwMAogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpc0NyZWF0ZVZvdGUgPT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLiR0b2FzdC5jbGVhcigpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuJG5vdGlmeSh7CiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICfmipXnpajliJvlu7rlpLHotKUnLAogICAgICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogMTAwMAogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpc1NhdmVPcHRpb24gPT0gZmFsc2UpIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLiR0b2FzdC5jbGVhcigpOwogICAgICAgICAgICAgICAgICAgIHRoaXMuJG5vdGlmeSh7CiAgICAgICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6ICfpgInpobnkv53lrZjlpLHotKUnLAogICAgICAgICAgICAgICAgICAgICAgICBkdXJhdGlvbjogMTAwMAogICAgICAgICAgICAgICAgICAgIH0pOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICB0aGlzLiR0b2FzdC5jbGVhcigpOwogICAgICAgICAgICAgICAgICAgIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gJy9teVZvdGUnOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgfSwKICAgICAgICBjaGVja1RpdGxlOmFzeW5jIGZ1bmN0aW9uKHRpbHRlKXsKICAgICAgICAgICAgbGV0IGlzRXhpc3Q9ZmFsc2U7CiAgICAgICAgICAgIGxldCBjaGVja1VybCA9IHRoaXMud2Vic2l0ZSArICIvdm90ZS9jaGVja1RpdGxlIjsKICAgICAgICAgICAgYXdhaXQgdGhpcy5heGlvcy5nZXQoY2hlY2tVcmwsIHsKICAgICAgICAgICAgICAgIHBhcmFtczogewogICAgICAgICAgICAgICAgICAgIHZvdGVUaXRsZTogdGlsdGUKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLmNvZGUgPT0gMjAwKSB7CiAgICAgICAgICAgICAgICAgICAgaXNFeGlzdCA9IHJlc3BvbnNlLmRhdGEuZGF0YTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIuajgOafpei/h+eoi+WHuumUmSIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7CiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZQogICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIHJldHVybiBpc0V4aXN0OwogICAgICAgIH0sCiAgICAgICAgc2F2ZVZvdGU6YXN5bmMgZnVuY3Rpb24odm90ZSl7CiAgICAgICAgICAgIGxldCBpc0NyZWF0ZVZvdGU9ZmFsc2U7CiAgICAgICAgICAgIGxldCB0aGF0PXRoaXM7CiAgICAgICAgICAgIGxldCBjcmVhdGVWb3RlVXJsID0gdGhpcy53ZWJzaXRlICsgIi92b3RlL2NyZWF0ZVZvdGUiOwogICAgICAgICAgICBhd2FpdCB0aGlzLmF4aW9zLnBvc3QoY3JlYXRlVm90ZVVybCwgdm90ZSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLmNvZGUgPT0gMjAwKSB7CiAgICAgICAgICAgICAgICAgICAgdGhhdC5uZXdWb3RlID0gcmVzcG9uc2UuZGF0YS5kYXRhOwogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKCLliJvlu7rmipXnpajmiJDlip8iKTsKICAgICAgICAgICAgICAgICAgICBpc0NyZWF0ZVZvdGUgPSB0cnVlOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZygi5Yib5bu65aSx6LSlIik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHsKICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlCiAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhlcnIpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcmV0dXJuIGlzQ3JlYXRlVm90ZTsKICAgICAgICB9LAogICAgICAgIHNhdmVPcHRpb246YXN5bmMgZnVuY3Rpb24oaW1nTmFtZSxpKXsKICAgICAgICAgICAgbGV0IGlzU2F2ZU9wdGlvbj1mYWxzZTsKICAgICAgICAgICAgbGV0IHNhdmVPcHRpb25VcmwgPSB0aGlzLndlYnNpdGUgKyAiL29wdGlvbi9zYXZlT3B0aW9uIjsKICAgICAgICAgICAgYXdhaXQgdGhpcy5heGlvcy5wb3N0KHNhdmVPcHRpb25VcmwsIHsKICAgICAgICAgICAgICAgIGltZzogaW1nTmFtZSwKICAgICAgICAgICAgICAgIGNvbnRlbnQ6IHRoaXMub3B0aW9uTGlzdFtpXS5jb250ZW50LAogICAgICAgICAgICAgICAgdm90ZTogdGhpcy5uZXdWb3RlLAogICAgICAgICAgICAgICAgdm90ZXM6IDAKICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgIGlmIChyZXNwb25zZS5kYXRhLmNvZGUgPT0gMjAwKSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coaSArICLpgInpobnmt7vliqDmiJDlip8iKTsKICAgICAgICAgICAgICAgICAgICBpc1NhdmVPcHRpb24gPSB0cnVlOwogICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICBjb25zb2xlLmxvZyhpICsgIumAiemhuea3u+WKoOWksei0pSIpOwogICAgICAgICAgICAgICAgICAgIGlzU2F2ZU9wdGlvbiA9IGZhbHNlOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7CiAgICAgICAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZQogICAgICAgICAgICAgICAgY29uc29sZS5sb2coZXJyKTsKICAgICAgICAgICAgfSkKICAgICAgICAgICAgcmV0dXJuIGlzU2F2ZU9wdGlvbjsKICAgICAgICB9LAogICAgICAgIGRlbFRhYmxlKGlkeCkgewogICAgICAgICAgICB0aGlzLm9wdGlvbkxpc3QgPSB0aGlzLm9wdGlvbkxpc3QuZmlsdGVyKCgKICAgICAgICAgICAgICAgIGl0ZW0sIGkpID0+IHsKICAgICAgICAgICAgICAgIC8vIGNvbnNvbGUubG9nKFtpdGVtLCBpLCBpZHhdKQogICAgICAgICAgICAgICAgaWYgKGkgIT0gaWR4KSB7CiAgICAgICAgICAgICAgICAgICAgcmV0dXJuICJlIgogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgYWRkVGFibGUoKSB7CiAgICAgICAgICAgIHRoaXMub3B0aW9uTGlzdC5wdXNoKHsKICAgICAgICAgICAgICAgIGltZzogW10sCiAgICAgICAgICAgICAgICBjb250ZW50OiAnJwogICAgICAgICAgICB9KQogICAgICAgIH0sCiAgICAgICAgb25TaG93MSgpIHsKICAgICAgICAgICAgdGhpcy50aW1lU2hvdzEgPSB0cnVlCiAgICAgICAgfSwKICAgICAgICBvblNob3cyKCkgewogICAgICAgICAgICB0aGlzLnRpbWVTaG93MiA9IHRydWUKICAgICAgICB9LAogICAgICAgIGNvbmZpcm1UaW1lMSh2YWx1ZSkgewogICAgICAgICAgICB0aGlzLnN0YXJ0VGltZSA9IHZhbHVlLmZvcm1hdCgieXl5eS1NTS1kZCBoaDptbSIpCiAgICAgICAgICAgIHRoaXMudGltZVNob3cxID0gZmFsc2UKICAgICAgICB9LAogICAgICAgIGNvbmZpcm1UaW1lMih2YWx1ZSkgewogICAgICAgICAgICB0aGlzLmRlYWRsaW5lID0gdmFsdWUuZm9ybWF0KCJ5eXl5LU1NLWRkIGhoOm1tIikKICAgICAgICAgICAgdGhpcy50aW1lU2hvdzIgPSBmYWxzZQogICAgICAgIH0sCiAgICAgICAgY2FuY2VsVGltZSgpIHsKICAgICAgICAgICAgdGhpcy50aW1lU2hvdzEgPSBmYWxzZQogICAgICAgICAgICB0aGlzLnRpbWVTaG93MiA9IGZhbHNlCiAgICAgICAgfSwKICAgICAgICBmb3JtYXR0ZXIodHlwZSwgdmFsdWUpIHsKICAgICAgICAgICAgaWYgKHR5cGUgPT09ICd5ZWFyJykgewogICAgICAgICAgICAgICAgcmV0dXJuIGAke3ZhbHVlfeW5tGA7CiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ21vbnRoJykgewogICAgICAgICAgICAgICAgcmV0dXJuIGAke3ZhbHVlfeaciGAKICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAnZGF5JykgewogICAgICAgICAgICAgICAgcmV0dXJuIGAke3ZhbHVlfeaXpWAKICAgICAgICAgICAgfSBlbHNlIGlmICh0eXBlID09PSAnaG91cicpIHsKICAgICAgICAgICAgICAgIHJldHVybiBgJHt2YWx1ZX3ml7ZgCiAgICAgICAgICAgIH0gZWxzZSBpZiAodHlwZSA9PT0gJ21pbnV0ZScpIHsKICAgICAgICAgICAgICAgIHJldHVybiBgJHt2YWx1ZX3liIZgCiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIHZhbHVlOwogICAgICAgIH0sCiAgICAgICAgdXBsb2FkSW1nOiBhc3luYyBmdW5jdGlvbiAoaW1nRmlsZSkgewogICAgICAgICAgICAvLyBsZXQgdGhhdD10aGlzOwogICAgICAgICAgICBsZXQgaW1nTmFtZSA9IGltZ0ZpbGUuZmlsZS5uYW1lOwogICAgICAgICAgICBsZXQgY29uZmlnID0gewogICAgICAgICAgICAgICAgaGVhZGVyczogeyAvL+a3u+WKoOivt+axguWktAogICAgICAgICAgICAgICAgICAgICJDb250ZW50LVR5cGUiOiAibXVsdGlwYXJ0L2Zvcm0tZGF0YSIKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfTsKICAgICAgICAgICAgbGV0IHVwbG9hZFVybCA9IHRoaXMud2Vic2l0ZSArICIvY29tbW9ucy91cGxvYWQiOwogICAgICAgICAgICBsZXQgcGFyYW1zID0gbmV3IEZvcm1EYXRhKCk7IC8v5Yib5bu6Zm9ybeWvueixoQogICAgICAgICAgICBwYXJhbXMuYXBwZW5kKCJmaWxlIiwgaW1nRmlsZS5maWxlKTsgLy/pgJrov4dhcHBlbmTlkJFmb3Jt5a+56LGh5re75Yqg5pWw5o2uLy/nrKzkuIDkuKrlj4LmlbDlrZfnrKbkuLLlj6/ku6Xloavku7vmhI/lkb3lkI3vvIznrKzkuozkuKrmoLnmja7lr7nosaHlsZ7mgKfmnaXmib7liLBmaWxlCiAgICAgICAgICAgIGF3YWl0IHRoaXMuYXhpb3MucG9zdCh1cGxvYWRVcmwsIHBhcmFtcywgY29uZmlnKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlLmRhdGEuY29kZSA9PSAyMDApIHsKICAgICAgICAgICAgICAgICAgICAvLyBpZihpbWdGaWxlPT10aGF0LmRlc2NyaXB0aW9uSW1nTGlzdFswXSl7CiAgICAgICAgICAgICAgICAgICAgLy8gICAgIHRoYXQuZGVzY3JpcHRpb25JbWdOYW1lPXJlc3BvbnNlLmRhdGEuZGF0YTsKICAgICAgICAgICAgICAgICAgICAvLyAgICAgLy8gY29uc29sZS5sb2codGhhdC5kZXNjcmlwdGlvbkltZ05hbWUpCiAgICAgICAgICAgICAgICAgICAgLy8gfWVsc2UgaWYoaW1nRmlsZT09dGhhdC5zaGFyZUltZ1swXSl7CiAgICAgICAgICAgICAgICAgICAgLy8gICAgIHRoYXQuc2hhcmVJbWdOYW1lPXJlc3BvbnNlLmRhdGEuZGF0YTsKICAgICAgICAgICAgICAgICAgICAvLyAgICAgLy8gY29uc29sZS5sb2codGhhdC5zaGFyZUltZ05hbWUpCiAgICAgICAgICAgICAgICAgICAgLy8gfQogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGltZ05hbWUgKyAi5Zu+54mH5LiK5Lyg5oiQ5YqfIik7CiAgICAgICAgICAgICAgICAgICAgaW1nTmFtZSA9IHJlc3BvbnNlLmRhdGEuZGF0YTsKICAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICAgY29uc29sZS5sb2coIuS4iuS8oOWksei0pSIpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbiAoICkgewogICAgICAgICAgICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGUKICAgICAgICAgICAgICAgICAvL2NvbnNvbGUubG9nKGVycik7CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIHJldHVybiBpbWdOYW1lOwogICAgICAgIH0KICAgIH0sCiAgICBtb3VudGVkKCkgewogICAgICAgIGxldCBkYXRlID0gbmV3IERhdGUoKTsKICAgICAgICBkYXRlLnNldERhdGUoZGF0ZS5nZXREYXRlKCkgKyA3KQogICAgICAgIHRoaXMuZGVhZGxpbmUgPSBkYXRlLmZvcm1hdCgieXl5eS1NTS1kZCBoaDptbSIpCiAgICAgICAgaWYgKHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oImxvZ2luVXNlciIpICE9IG51bGwgfHwgbG9jYWxTdG9yYWdlLmdldEl0ZW0oImxvZ2luVXNlciIpICE9IG51bGwpIHsKICAgICAgICAgICAgdGhpcy5pc0xvZ2luID0gdHJ1ZTsKICAgICAgICAgICAgaWYgKHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oImxvZ2luVXNlciIpICE9IG51bGwpIHsKICAgICAgICAgICAgICAgIHRoaXMubG9naW5Vc2VyID0gSlNPTi5wYXJzZShzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCJsb2dpblVzZXIiKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGxvY2FsU3RvcmFnZS5nZXRJdGVtKCJsb2dpblVzZXIiKSAhPSBudWxsKSB7CiAgICAgICAgICAgICAgICB0aGlzLmxvZ2luVXNlciA9IEpTT04ucGFyc2UobG9jYWxTdG9yYWdlLmdldEl0ZW0oImxvZ2luVXNlciIpKTsKICAgICAgICAgICAgfQogICAgICAgIH0KICAgIH0KfQpEYXRlLnByb3RvdHlwZS5mb3JtYXQgPSBmdW5jdGlvbiAoZm10KSB7CiAgICB2YXIgbyA9IHsKICAgICAgICAiTSsiOiB0aGlzLmdldE1vbnRoKCkgKyAxLCAgICAgICAgICAgICAgICAgLy/mnIjku70KICAgICAgICAiZCsiOiB0aGlzLmdldERhdGUoKSwgICAgICAgICAgICAgICAgICAgIC8v5pelCiAgICAgICAgImgrIjogdGhpcy5nZXRIb3VycygpLCAgICAgICAgICAgICAgICAgICAvL+Wwj+aXtgogICAgICAgICJtKyI6IHRoaXMuZ2V0TWludXRlcygpLCAgICAgICAgICAgICAgICAgLy/liIYKICAgICAgICAicysiOiB0aGlzLmdldFNlY29uZHMoKSwgICAgICAgICAgICAgICAgIC8v56eSCiAgICAgICAgInErIjogTWF0aC5mbG9vcigodGhpcy5nZXRNb250aCgpICsgMykgLyAzKSwgLy/lraPluqYKICAgICAgICAiUyI6IHRoaXMuZ2V0TWlsbGlzZWNvbmRzKCkgICAgICAgICAgICAgLy/mr6vnp5IKICAgIH07CgogICAgaWYgKC8oeSspLy50ZXN0KGZtdCkpIHsKICAgICAgICBmbXQgPSBmbXQucmVwbGFjZShSZWdFeHAuJDEsICh0aGlzLmdldEZ1bGxZZWFyKCkgKyAiIikuc3Vic3RyKDQgLSBSZWdFeHAuJDEubGVuZ3RoKSk7CiAgICB9CgogICAgZm9yICh2YXIgayBpbiBvKSB7CiAgICAgICAgaWYgKG5ldyBSZWdFeHAoIigiICsgayArICIpIikudGVzdChmbXQpKSB7CiAgICAgICAgICAgIGZtdCA9IGZtdC5yZXBsYWNlKAogICAgICAgICAgICAgICAgUmVnRXhwLiQxLCAoUmVnRXhwLiQxLmxlbmd0aCA9PSAxKSA/IChvW2tdKSA6ICgoIjAwIiArIG9ba10pLnN1YnN0cigoIiIgKyBvW2tdKS5sZW5ndGgpKSk7CiAgICAgICAgfQogICAgfQogICAgcmV0dXJuIGZtdDsKfQoK"},{"version":3,"sources":["newImageVote.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAqGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"newImageVote.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n    <div style=\"margin-bottom: 100px\">\r\n        <van-cell-group>\r\n            <van-field v-model=\"voteTilte\" placeholder=\"投票标题\"/>\r\n            <van-field\r\n                    v-model=\"description\"\r\n                    rows=\"4\"\r\n                    type=\"textarea\"\r\n                    placeholder=\"请输入描述（图片可选）\"\r\n                    show-word-limit\r\n            />\r\n        </van-cell-group>\r\n        <van-uploader v-model=\"descriptionImgList\" :max-count=\"1\" :max-size=maxsize :oversize=\"oversize\"\r\n                      style=\"margin: 8px 8px\"/>\r\n        <hr style=\"height: 7px\">\r\n        <van-cell-group v-for=\"(item,i) in optionList\" :key=\"i\">\r\n            <van-row>\r\n                <van-col span=\"2\">\r\n                    <img src=\"../assets/images/del.png\" style=\"margin:12px 5px;\" height=\"24px\" width=\"24px\"\r\n                         @click=\"delTable(i)\">\r\n                </van-col>\r\n                <van-col span=\"3\">\r\n                    <van-uploader v-model=\"item.img\" preview-size=\"42px\" :max-count=\"1\"\r\n                                  style=\"margin-top: 5px\"/>\r\n                </van-col>\r\n                <van-col span=\"19\">\r\n                    <van-field v-model=\"item.content\" placeholder=\"选项内容\" style=\"margin-top: 5px\"/>\r\n                </van-col>\r\n            </van-row>\r\n        </van-cell-group>\r\n        <van-row>\r\n            <van-col span=\"2\">\r\n                <img src=\"../assets/images/add.png\" style=\"margin:12px 5px;\" height=\"24px\" width=\"24px\"\r\n                     @click=\"addTable()\">\r\n            </van-col>\r\n            <van-col span=\"22\">\r\n                <span style=\"color: #2a89ff;display: block;margin-top: 10px\" @click=\"addTable()\">添加选项</span>\r\n            </van-col>\r\n        </van-row>\r\n        <hr style=\"height: 7px\">\r\n        <van-cell-group>\r\n            <van-field v-model=\"maxVote\" placeholder=\"每人最多可投(默认为1)\" type=\"number\"/>\r\n            <van-row>\r\n                <van-col span=\"21\">\r\n                    <span style=\"display: block;margin: 14px 16px\">自定义分享图（选填）</span>\r\n                </van-col>\r\n                <van-col span=\"3\">\r\n                    <van-uploader v-model=\"shareImg\" preview-size=\"42px\" :max-count=\"1\"\r\n                                  style=\"margin-top: 5px\"/>\r\n                </van-col>\r\n            </van-row>\r\n        </van-cell-group>\r\n        <van-cell-group>\r\n            <van-row>\r\n                <van-col span=\"16\">\r\n                    <span style=\"display: block;margin: 14px 16px\">开始时间</span>\r\n                </van-col>\r\n                <van-col span=\"8\">\r\n                    <span @click=\"onShow1\" style=\"display: block;margin-top: 14px\">{{startTime}}</span>\r\n                </van-col>\r\n            </van-row>\r\n        </van-cell-group>\r\n        <van-cell-group>\r\n            <van-row>\r\n                <van-col span=\"16\">\r\n                    <span style=\"display: block;margin: 14px 16px\">截止时间</span>\r\n                </van-col>\r\n                <van-col span=\"8\">\r\n                    <span @click=\"onShow2\" style=\"display: block;margin-top: 14px\">{{deadline}}</span>\r\n                </van-col>\r\n            </van-row>\r\n        </van-cell-group>\r\n        <van-action-sheet v-model=\"timeShow1\">\r\n            <van-datetime-picker\r\n                    v-model=\"timeSet.currentDate\"\r\n                    type=\"datetime\"\r\n                    :min-date=\"timeSet.minDate\"\r\n                    :max-date=\"timeSet.maxDate\"\r\n                    :formatter=\"formatter\"\r\n                    @confirm=\"confirmTime1\"\r\n                    @cancel=\"cancelTime\"\r\n            />\r\n        </van-action-sheet>\r\n        <van-action-sheet v-model=\"timeShow2\">\r\n            <van-datetime-picker\r\n                    v-model=\"timeSet.currentDate\"\r\n                    type=\"datetime\"\r\n                    :min-date=\"timeSet.minDate\"\r\n                    :max-date=\"timeSet.maxDate\"\r\n                    :formatter=\"formatter\"\r\n                    @confirm=\"confirmTime2\"\r\n                    @cancel=\"cancelTime\"\r\n            />\r\n        </van-action-sheet>\r\n        <div class=\"d-flex justify-content-center\">\r\n            <button type=\"button\" class=\"btn btn-primary\" style=\"margin-top: 20px\" @click=\"createVote\">立即发起投票</button>\r\n        </div>\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    export default {\r\n        name: \"newImageVote\",\r\n        data() {\r\n            return {\r\n                maxsize:1000000,\r\n                isLogin: false,\r\n                loginUser: {},\r\n                timeShow1: false,\r\n                timeShow2: false,\r\n                voteTilte: '',\r\n                optionList: [{\r\n                    img: [],\r\n                    content: ''\r\n                }, {\r\n                    img: [],\r\n                    content: ''\r\n                }\r\n                ],\r\n                description: '',\r\n                //简介图片\r\n                descriptionImgList: [],\r\n                //分享图片\r\n                shareImg: [],\r\n                maxVote: '',\r\n                timeSet: {\r\n                    minDate: new Date(),\r\n                    maxDate: new Date(2100, 11, 31),\r\n                    currentDate: new Date()\r\n                },\r\n                startTime: new Date().format(\"yyyy-MM-dd hh:mm\"),\r\n                deadline: '',\r\n                newVote: {},\r\n            }\r\n        },\r\n        methods: {\r\n\r\n            // afterRead(file) {\r\n            //     console.log(file)\r\n            // },\r\n            // test(){\r\n            //     this.$notify({\r\n            //         message: '图片上传失败',\r\n            //         duration: 1000\r\n            //     });\r\n            // },\r\n            oversize(file){\r\n                console.log(file)\r\n                this.$dialog.alert({\r\n                    message: '图片大小不能超过1M'\r\n                }).then(() => {\r\n                    // on close\r\n                });\r\n            },\r\n            createVote: async function () {\r\n                if (this.voteTilte == '') {\r\n                    this.$dialog.alert({\r\n                        message: '请填写标题'\r\n                    }).then(() => {\r\n                        // on close\r\n                    });\r\n                } else if (this.optionList.length == 0) {\r\n                    this.$dialog.alert({\r\n                        message: '请至少添加一个选项'\r\n                    }).then(() => {\r\n                        // on close\r\n                    });\r\n                } else {\r\n                    for (let i in this.optionList) {\r\n                        if (this.optionList[i].img[0] == null) {\r\n                            this.$dialog.alert({\r\n                                message: '请上传选项图片'\r\n                            }).then(() => {\r\n                                // on close\r\n                            });\r\n                            return;\r\n                        } else if (this.optionList[i].content == '') {\r\n                            this.$dialog.alert({\r\n                                message: '请填写标题选项内容'\r\n                            }).then(() => {\r\n                                // on close\r\n                            });\r\n                            return;\r\n                        }\r\n                    }\r\n                    //检查标题唯一性\r\n                    let isExist=await this.checkTitle(this.voteTilte);\r\n                    if (isExist == false) {\r\n                        console.log(\"标题已存在\");\r\n                        this.$dialog.alert({\r\n                            message: '该标题已存在'\r\n                        }).then(() => {\r\n                            // on close\r\n                        });\r\n                        return;\r\n                    }\r\n                    this.$toast.loading({\r\n                        message: '创建中...',\r\n                        forbidClick: true,\r\n                        duration: 0,\r\n                    });\r\n                    let isUpload = true;\r\n                    let isCreateVote = false;\r\n                    let isSaveOption = false;\r\n                    //将最大投票数默认置为1\r\n                    if (this.maxVote == null) {\r\n                        this.maxVote = 1;\r\n                    }\r\n                    let vote = {\r\n                        creator: this.loginUser,\r\n                        title: this.voteTilte,\r\n                        description: this.description,\r\n                        descriptionImg: \"\",\r\n                        shareImg: \"\",\r\n                        startTime: this.startTime,\r\n                        deadline: this.deadline,\r\n                        onceMaxVote: this.maxVote,\r\n                    };\r\n                    //上传图片\r\n                    if (this.descriptionImgList[0] != null) {\r\n                        //同步执行 需等待文件上传完毕\r\n                        vote.descriptionImg = await this.uploadImg(this.descriptionImgList[0]);\r\n                        if (vote.descriptionImg == null) {\r\n                            isUpload = false;\r\n                        }\r\n                    }\r\n                    if (this.shareImg[0] != null) {\r\n                        vote.shareImg = await this.uploadImg(this.shareImg[0]);\r\n                        if (vote.shareImg == null) {\r\n                            isUpload = false;\r\n                        }\r\n                    }\r\n                    // console.log(vote)\r\n                    //保存投票信息\r\n                    isCreateVote=await this.saveVote(vote);\r\n                    //保存选项信息\r\n                    for (let i in this.optionList) {\r\n                        let imgName = await this.uploadImg(this.optionList[i].img[0]);\r\n                        if (imgName == null) {\r\n                            isUpload = false;\r\n                        }\r\n                        isSaveOption=await this.saveOption(imgName,i)\r\n                    }\r\n                    if (isUpload == false) {\r\n                        this.$toast.clear();\r\n                        this.$notify({\r\n                            message: '图片上传失败',\r\n                            duration: 1000\r\n                        });\r\n                    } else if (isCreateVote == false) {\r\n                        this.$toast.clear();\r\n                        this.$notify({\r\n                            message: '投票创建失败',\r\n                            duration: 1000\r\n                        });\r\n                    } else if (isSaveOption == false) {\r\n                        this.$toast.clear();\r\n                        this.$notify({\r\n                            message: '选项保存失败',\r\n                            duration: 1000\r\n                        });\r\n                    } else {\r\n                        this.$toast.clear();\r\n                        window.location.href = '/myVote';\r\n                    }\r\n                }\r\n            },\r\n            checkTitle:async function(tilte){\r\n                let isExist=false;\r\n                let checkUrl = this.website + \"/vote/checkTitle\";\r\n                await this.axios.get(checkUrl, {\r\n                    params: {\r\n                        voteTitle: tilte\r\n                    }\r\n                }).then(function (response) {\r\n                    if (response.data.code == 200) {\r\n                        isExist = response.data.data;\r\n                    } else {\r\n                        console.log(\"检查过程出错\");\r\n                    }\r\n                }).catch(function (err) {\r\n                    // eslint-disable-next-line no-console\r\n                    console.log(err);\r\n                });\r\n                return isExist;\r\n            },\r\n            saveVote:async function(vote){\r\n                let isCreateVote=false;\r\n                let that=this;\r\n                let createVoteUrl = this.website + \"/vote/createVote\";\r\n                await this.axios.post(createVoteUrl, vote).then(function (response) {\r\n                    if (response.data.code == 200) {\r\n                        that.newVote = response.data.data;\r\n                        console.log(\"创建投票成功\");\r\n                        isCreateVote = true;\r\n                    } else {\r\n                        console.log(\"创建失败\");\r\n                    }\r\n                }).catch(function (err) {\r\n                    // eslint-disable-next-line no-console\r\n                    console.log(err);\r\n                });\r\n                return isCreateVote;\r\n            },\r\n            saveOption:async function(imgName,i){\r\n                let isSaveOption=false;\r\n                let saveOptionUrl = this.website + \"/option/saveOption\";\r\n                await this.axios.post(saveOptionUrl, {\r\n                    img: imgName,\r\n                    content: this.optionList[i].content,\r\n                    vote: this.newVote,\r\n                    votes: 0\r\n                }).then(function (response) {\r\n                    if (response.data.code == 200) {\r\n                        console.log(i + \"选项添加成功\");\r\n                        isSaveOption = true;\r\n                    } else {\r\n                        console.log(i + \"选项添加失败\");\r\n                        isSaveOption = false;\r\n                    }\r\n                }).catch(function (err) {\r\n                    // eslint-disable-next-line no-console\r\n                    console.log(err);\r\n                })\r\n                return isSaveOption;\r\n            },\r\n            delTable(idx) {\r\n                this.optionList = this.optionList.filter((\r\n                    item, i) => {\r\n                    // console.log([item, i, idx])\r\n                    if (i != idx) {\r\n                        return \"e\"\r\n                    }\r\n                })\r\n            },\r\n            addTable() {\r\n                this.optionList.push({\r\n                    img: [],\r\n                    content: ''\r\n                })\r\n            },\r\n            onShow1() {\r\n                this.timeShow1 = true\r\n            },\r\n            onShow2() {\r\n                this.timeShow2 = true\r\n            },\r\n            confirmTime1(value) {\r\n                this.startTime = value.format(\"yyyy-MM-dd hh:mm\")\r\n                this.timeShow1 = false\r\n            },\r\n            confirmTime2(value) {\r\n                this.deadline = value.format(\"yyyy-MM-dd hh:mm\")\r\n                this.timeShow2 = false\r\n            },\r\n            cancelTime() {\r\n                this.timeShow1 = false\r\n                this.timeShow2 = false\r\n            },\r\n            formatter(type, value) {\r\n                if (type === 'year') {\r\n                    return `${value}年`;\r\n                } else if (type === 'month') {\r\n                    return `${value}月`\r\n                } else if (type === 'day') {\r\n                    return `${value}日`\r\n                } else if (type === 'hour') {\r\n                    return `${value}时`\r\n                } else if (type === 'minute') {\r\n                    return `${value}分`\r\n                }\r\n                return value;\r\n            },\r\n            uploadImg: async function (imgFile) {\r\n                // let that=this;\r\n                let imgName = imgFile.file.name;\r\n                let config = {\r\n                    headers: { //添加请求头\r\n                        \"Content-Type\": \"multipart/form-data\"\r\n                    }\r\n                };\r\n                let uploadUrl = this.website + \"/commons/upload\";\r\n                let params = new FormData(); //创建form对象\r\n                params.append(\"file\", imgFile.file); //通过append向form对象添加数据//第一个参数字符串可以填任意命名，第二个根据对象属性来找到file\r\n                await this.axios.post(uploadUrl, params, config).then(function (response) {\r\n                    if (response.data.code == 200) {\r\n                        // if(imgFile==that.descriptionImgList[0]){\r\n                        //     that.descriptionImgName=response.data.data;\r\n                        //     // console.log(that.descriptionImgName)\r\n                        // }else if(imgFile==that.shareImg[0]){\r\n                        //     that.shareImgName=response.data.data;\r\n                        //     // console.log(that.shareImgName)\r\n                        // }\r\n                        console.log(imgName + \"图片上传成功\");\r\n                        imgName = response.data.data;\r\n                    } else {\r\n                        console.log(\"上传失败\");\r\n                    }\r\n                }).catch(function ( ) {\r\n                    // eslint-disable-next-line no-console\r\n                     //console.log(err);\r\n                })\r\n                return imgName;\r\n            }\r\n        },\r\n        mounted() {\r\n            let date = new Date();\r\n            date.setDate(date.getDate() + 7)\r\n            this.deadline = date.format(\"yyyy-MM-dd hh:mm\")\r\n            if (sessionStorage.getItem(\"loginUser\") != null || localStorage.getItem(\"loginUser\") != null) {\r\n                this.isLogin = true;\r\n                if (sessionStorage.getItem(\"loginUser\") != null) {\r\n                    this.loginUser = JSON.parse(sessionStorage.getItem(\"loginUser\"));\r\n                }\r\n                if (localStorage.getItem(\"loginUser\") != null) {\r\n                    this.loginUser = JSON.parse(localStorage.getItem(\"loginUser\"));\r\n                }\r\n            }\r\n        }\r\n    }\r\n    Date.prototype.format = function (fmt) {\r\n        var o = {\r\n            \"M+\": this.getMonth() + 1,                 //月份\r\n            \"d+\": this.getDate(),                    //日\r\n            \"h+\": this.getHours(),                   //小时\r\n            \"m+\": this.getMinutes(),                 //分\r\n            \"s+\": this.getSeconds(),                 //秒\r\n            \"q+\": Math.floor((this.getMonth() + 3) / 3), //季度\r\n            \"S\": this.getMilliseconds()             //毫秒\r\n        };\r\n\r\n        if (/(y+)/.test(fmt)) {\r\n            fmt = fmt.replace(RegExp.$1, (this.getFullYear() + \"\").substr(4 - RegExp.$1.length));\r\n        }\r\n\r\n        for (var k in o) {\r\n            if (new RegExp(\"(\" + k + \")\").test(fmt)) {\r\n                fmt = fmt.replace(\r\n                    RegExp.$1, (RegExp.$1.length == 1) ? (o[k]) : ((\"00\" + o[k]).substr((\"\" + o[k]).length)));\r\n            }\r\n        }\r\n        return fmt;\r\n    }\r\n\r\n</script>\r\n\r\n<style scoped>\r\n    hr {\r\n        margin-top: 0px;\r\n        margin: 0;\r\n        border: 0;\r\n        color: #e0e0e0;\r\n        background-color: #e0e0e0;\r\n        height: 1px\r\n    }\r\n</style>"]}]}